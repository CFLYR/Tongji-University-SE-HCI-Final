# 统一PPT手势识别播放器 - 使用说明

##  项目简介

这是一个基于计算机视觉和手势识别技术的统一PPT播放控制系统，支持通过手势控制幻灯片播放，具备自定义手势配置功能。

##  功能特性

### 基础播放控制
- **下一页/上一页**: 左右滑动手势
- **暂停/播放**: 拳头手势
- **退出演示**: 双手交叉手势 (长按2秒)
- **全屏切换**: 张开五指手势 (长按1秒)

### 高级交互功能
- **激光指示器**: 食指指向，实时显示指示点
- **页面跳转**: 数字手势 (1-5指) 长按1.5秒跳转到对应页面
- **实时反馈**: 显示当前识别的手势和置信度
- **状态监控**: 实时显示FPS、当前页面、系统状态

### 自定义手势系统
- **手势录制**: 支持录制新的手势模式
- **模式训练**: 多样本训练提高识别准确度
- **配置管理**: 保存和加载自定义手势配置
- **实时测试**: 测试自定义手势的识别效果

##  安装和使用

### 环境要求
```bash
Python 3.8+
Windows 10/11 (支持PowerPoint)
摄像头 (内置或外接)
```

### 依赖安装
```bash
pip install opencv-python==4.8.1.78
pip install mediapipe==0.10.7
pip install numpy==1.24.3
pip install pyautogui==0.9.54
```

### 运行程序

#### 1. 主程序 - 统一手势控制器
```bash
python unified_ppt_gesture_controller.py
```

#### 2. 自定义手势管理器
```bash
python custom_gesture_manager.py
```

##  手势映射表

| 手势类型 | 手势描述 | 功能 | 触发条件 |
|---------|---------|------|---------|
| 静态手势 | ✊ 拳头 | 暂停/播放 | 置信度 > 0.9 |
| 动态手势 | 👉 右滑 | 下一页 | 置信度 > 0.7 |
| 动态手势 | 👈 左滑 | 上一页 | 置信度 > 0.7 |
| 静态手势 | ☝️ 食指 | 激光指示器 | 置信度 > 0.8 |
| 静态手势 | ✋ 张开手掌 | 全屏切换 | 长按1秒 |
| 静态手势 | 1️⃣ 一个手指 | 跳转第1页 | 长按1.5秒 |
| 静态手势 | 2️⃣ 两个手指 | 跳转第2页 | 长按1.5秒 |
| 静态手势 | 3️⃣ 三个手指 | 跳转第3页 | 长按1.5秒 |
| 静态手势 | 4️⃣ 四个手指 | 跳转第4页 | 长按1.5秒 |
| 静态手势 | 5️⃣ 五个手指 | 跳转第5页 | 长按1.5秒 |
| 双手手势 | 🤝 双手握拳 | 退出演示 | 长按2秒 |

## ⌨ 键盘控制

| 按键 | 功能 |
|------|------|
| H | 显示/隐藏帮助信息 |
| C | 开启/关闭校准模式 |
| S | 保存当前手势配置 |
| Q/ESC | 退出程序 |

##  自定义手势配置

### 创建自定义手势
1. 运行 `custom_gesture_manager.py`
2. 选择 "创建新的自定义手势"
3. 输入手势名称和描述
4. 按空格键开始录制手势
5. 重复做手势动作 3-5 秒
6. 再次按空格键停止录制
7. 系统自动保存手势模板

### 测试自定义手势
1. 在自定义手势管理器中选择 "测试自定义手势"
2. 选择要测试的手势
3. 做出对应手势，观察识别结果
4. 按ESC退出测试

### 手势配置文件
- `gesture_config.json`: 主程序手势配置
- `custom_gestures.json`: 自定义手势配置

## 高级配置

### 调整识别敏感度
编辑 `gesture_config.json` 文件中的参数：
```json
{
  "gesture_name": {
    "confidence_threshold": 0.8,  //置信度阈值 (0.0-1.0)
    "hold_duration": 1.0,         //持续时间要求 (秒)
    "enabled": true,               //是否启用
  }
}
```

### 自定义动作映射
可以修改 `PPTAction` 枚举类来添加新的控制动作，支持：
- PowerPoint 控制
- 系统快捷键
- 自定义脚本执行

##  故障排除

### 常见问题


### 调试模式
程序提供了详细的调试信息：
- 实时FPS显示
- 手势识别置信度
- 手部关键点可视化 (校准模式)
- 系统状态监控

### 日志输出
程序会在控制台输出详细的运行信息，包括：
- 手势识别结果
- 操作执行状态
- 错误信息和异常